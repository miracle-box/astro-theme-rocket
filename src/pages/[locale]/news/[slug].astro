---
import { locales } from '@i18n';
import Layout from '@layouts/news-content.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const allNewsPosts = await getCollection('news');

	const pages = [];
	for (const locale of locales) {
		pages.push(
			...allNewsPosts.map((p) => {
				return { params: { locale, slug: p.slug } };
			}),
		);
	}

	return pages;
}

// Render the content
const { slug } = Astro.params;
const allNewsPosts = await getCollection('news');
const thisPage = allNewsPosts.find((p) => p.slug === slug);
const { Content } = await thisPage!.render();
---

<Layout>
	<Content />
</Layout>
